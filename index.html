<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Суп дня</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel для JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Шрифты -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet" />

  <style>
    :root {
      font-size: 16px;
    }

    body {
      font-family: 'Inter', sans-serif;
      background:
        radial-gradient(circle at 20% 0%, #333b49 0, transparent 55%),
        radial-gradient(circle at 80% 0%, #1c2737 0, transparent 60%),
        linear-gradient(to bottom, #05060a, #10141e 40%, #04050a 100%);
    }

    .font-mono {
      font-family: 'Space Mono', monospace;
    }

    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* Корпус плеера (Sony-style) */
    .device-shell {
      border-radius: 2.2rem;
      padding: 0.9rem;
      background:
        linear-gradient(145deg, #444c57, #171b22);
      box-shadow:
        0 1.5rem 3.5rem rgba(0, 0, 0, 0.85),
        inset 0.05rem 0.05rem 0.2rem rgba(255, 255, 255, 0.25),
        inset -0.07rem -0.07rem 0.25rem rgba(0, 0, 0, 0.7);
    }

    .device-inner {
      border-radius: 1.8rem;
      background:
        linear-gradient(160deg, #15171d, #07080c);
      box-shadow:
        inset 0.09rem 0.09rem 0.35rem rgba(0, 0, 0, 0.9),
        inset -0.09rem -0.09rem 0.35rem rgba(255, 255, 255, 0.08);
      padding: 1.3rem 1.2rem;
    }

    /* Вдавленный дисплей */
    .concave-display {
      border-radius: 1.2rem;
      background: radial-gradient(circle at 50% 25%, #202638 0, #05060b 55%, #020308 100%);
      box-shadow:
        inset 0.15rem 0.15rem 0.55rem rgba(0, 0, 0, 0.95),
        inset -0.12rem -0.12rem 0.45rem rgba(255, 255, 255, 0.12);
      position: relative;
      overflow: hidden;
    }

    .display-glow {
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 10% 0%, rgba(255, 255, 255, 0.25) 0, transparent 45%),
        radial-gradient(circle at 90% 100%, rgba(16, 185, 129, 0.1) 0, transparent 55%);
      pointer-events: none;
      mix-blend-mode: screen;
    }

    /* Вдавленный динамик */
    .concave-speaker {
      border-radius: 1.4rem;
      background: radial-gradient(circle at 40% 30%, #3b414c 0, #191b22 50%, #050509 100%);
      box-shadow:
        inset 0.18rem 0.18rem 0.6rem rgba(0, 0, 0, 0.95),
        inset -0.16rem -0.16rem 0.5rem rgba(255, 255, 255, 0.08);
      position: relative;
      overflow: hidden;
    }

    .speaker-pattern {
      position: absolute;
      inset: 10%;
      border-radius: 1.2rem;
      background-image: radial-gradient(circle at center, #07080c 0.04rem, transparent 0.04rem);
      background-size: 0.35rem 0.35rem;
      opacity: 0.9;
    }

    /* Выпуклые кнопки */
    .round-button {
      border-radius: 999rem;
      background: linear-gradient(145deg, #f5f5f7, #b5bcc7);
      box-shadow:
        0 0.35rem 0.7rem rgba(0, 0, 0, 0.6),
        inset 0.04rem 0.04rem 0.09rem rgba(255, 255, 255, 0.85);
      border: 0.12rem solid rgba(154, 162, 176, 1);
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out;
    }

    .round-button:active {
      transform: translateY(0.08rem);
      box-shadow:
        0 0.18rem 0.45rem rgba(0, 0, 0, 0.55),
        inset 0.05rem 0.05rem 0.16rem rgba(0, 0, 0, 0.4);
    }

    /* Верхние REW/FWD */
    .top-key {
      border-radius: 0.6rem 0.6rem 0 0;
      background: linear-gradient(180deg, #f9fafb, #c8ced8);
      box-shadow:
        0 0.2rem 0.4rem rgba(0, 0, 0, 0.6),
        inset 0.04rem 0.04rem 0.08rem rgba(255, 255, 255, 0.9);
      border: 0.09rem solid rgba(114, 121, 134, 1);
      border-bottom: none;
      padding: 0.2rem 0.8rem;
      font-size: 0.6rem;
      letter-spacing: 0.25em;
    }

    .top-key:active {
      transform: translateY(0.08rem);
      box-shadow:
        0 0.1rem 0.3rem rgba(0, 0, 0, 0.7),
        inset 0.04rem 0.04rem 0.11rem rgba(0, 0, 0, 0.35);
    }

    /* Лёгкий толчок корпуса при перемотке */
    @keyframes jogForward {
      0%   { transform: translateX(0) translateY(0) rotate(0); }
      30%  { transform: translateX(0.25rem) translateY(0.1rem) rotate(0.2deg); }
      100% { transform: translateX(0) translateY(0) rotate(0); }
    }
    @keyframes jogBack {
      0%   { transform: translateX(0) translateY(0) rotate(0); }
      30%  { transform: translateX(-0.25rem) translateY(0.1rem) rotate(-0.2deg); }
      100% { transform: translateX(0) translateY(0) rotate(0); }
    }
    .jog-forward {
      animation: jogForward 0.22s ease-out;
    }
    .jog-back {
      animation: jogBack 0.22s ease-out;
    }

    .no-select {
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 text-neutral-100">
  <div id="root" class="w-full max-w-6xl mx-auto"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Формат времени mm:ss
    const formatTime = (sec) => {
      if (!sec || !isFinite(sec)) return "00:00";
      const s = Math.floor(sec);
      const m = Math.floor(s / 60);
      const r = s % 60;
      const mm = m.toString().padStart(2, "0");
      const ss = r.toString().padStart(2, "0");
      return `${mm}:${ss}`;
    };

    // Кассета — чёрная, минималистичная
    const Cassette = ({ soup, active, onSelect }) => {
      const title = soup.playlistTitle || soup.title || soup.id;
      const tagline = soup.playlistTagline || soup.tagline || "Cassette";

      return (
        <button
          onClick={() => onSelect(soup)}
          className={[
            "relative flex-shrink-0 w-48 h-28 md:w-56 md:h-32",
            "rounded-xl border no-select transition-transform duration-200",
            "bg-gradient-to-br from-neutral-900 via-black to-neutral-800",
            active
              ? "border-orange-400 shadow-[0_1.2rem_2.4rem_rgba(248,113,22,0.55)] scale-105"
              : "border-neutral-600/80 shadow-[0_0.9rem_1.5rem_rgba(0,0,0,0.75)] hover:scale-105 hover:border-neutral-200"
          ].join(" ")}
        >
          {/* Внутренний блок */}
          <div className="absolute inset-[0.4rem] rounded-lg bg-neutral-950 border border-neutral-700/70 flex flex-col">
            {/* Лейбл */}
            <div className="flex items-center gap-2 px-3 py-2 border-b border-neutral-700/60 bg-gradient-to-r from-neutral-900 to-neutral-800">
              <div className="w-7 h-7 rounded-md bg-gradient-to-br from-neutral-200 to-neutral-500 flex items-center justify-center text-xs font-mono text-neutral-900">
                T
              </div>
              <div className="flex flex-col flex-1">
                <span className="text-xs font-semibold truncate">{title}</span>
                <span className="text-[0.6rem] text-neutral-400 truncate uppercase tracking-[0.18em]">
                  {tagline}
                </span>
              </div>
            </div>
            {/* Окошко ленты */}
            <div className="flex-1 flex items-center justify-between px-4">
              <div className="w-9 h-9 rounded-full bg-gradient-to-br from-neutral-700 to-neutral-900 border border-black shadow-[inset_0.09rem_0.09rem_0.25rem_rgba(0,0,0,0.9),0_0.4rem_0.8rem_rgba(0,0,0,0.9)]" />
              <div className="flex-1 mx-3 h-4 rounded bg-gradient-to-r from-neutral-700 via-neutral-600 to-neutral-700 shadow-[inset_0.08rem_0.08rem_0.18rem_rgba(0,0,0,0.9)]" />
              <div className="w-9 h-9 rounded-full bg-gradient-to-br from-neutral-700 to-neutral-900 border border-black shadow-[inset_0.09rem_0.09rem_0.25rem_rgba(0,0,0,0.9),0_0.4rem_0.8rem_rgba(0,0,0,0.9)]" />
            </div>
          </div>
        </button>
      );
    };

    // Простая полоска-спектр (fake, но лёгкая)
    const MiniSpectrum = ({ active }) => {
      const bars = Array.from({ length: 12 }, (_, i) => i);
      return (
        <div className="flex items-end gap-[0.1rem] h-6">
          {bars.map((i) => {
            const base = (i % 3) + 1;
            const heightClass = active ? `h-${base + 2}` : "h-1";
            return (
              <div
                key={i}
                className={[
                  "w-[0.18rem] rounded-full bg-gradient-to-t from-emerald-500 to-emerald-300",
                  heightClass
                ].join(" ")}
              />
            );
          })}
        </div>
      );
    };

    function App() {
      const [soups, setSoups] = useState([]);
      const [loadingSoups, setLoadingSoups] = useState(true);
      const [soupsError, setSoupsError] = useState(null);

      const [currentSoupId, setCurrentSoupId] = useState(null);
      const [currentTrackIndex, setCurrentTrackIndex] = useState(0);

      const [isPlaying, setIsPlaying] = useState(false);
      const [volume, setVolume] = useState(70);

      const [currentTime, setCurrentTime] = useState(0);
      const [duration, setDuration] = useState(0);

      const [jogClass, setJogClass] = useState("");
      const [forwardCue, setForwardCue] = useState(false);
      const [rewinding, setRewinding] = useState(false);

      const audioRef = useRef(null);
      const rewIntervalRef = useRef(null);

      // Загрузка soups/index.json
      useEffect(() => {
        const load = async () => {
          try {
            const res = await fetch("soups/index.json");
            if (!res.ok) throw new Error("soups/index.json not found");
            const data = await res.json();
            const list = (data.soups || []).map((s, i) => ({
              ...s,
              tracks: [],
              tracksLoaded: false,
              order: i
            }));
            setSoups(list);
            setSoupsError(null);
          } catch (e) {
            console.error(e);
            setSoupsError("Не удалось загрузить soups/index.json");
          } finally {
            setLoadingSoups(false);
          }
        };
        load();
      }, []);

      // Суп дня по умолчанию
      useEffect(() => {
        if (!soups.length || currentSoupId) return;
        const day = new Date().getDay(); // 0..6
        const daySoup = soups.find(
          (s) => s.type === "day" && s.dayOfWeek === day
        );
        const toSet = daySoup || soups[0];
        if (toSet) {
          setCurrentSoupId(toSet.id);
          setCurrentTrackIndex(0);
        }
      }, [soups, currentSoupId]);

      const currentSoup = soups.find((s) => s.id === currentSoupId) || null;
      const currentTrack =
        currentSoup && currentSoup.tracks && currentSoup.tracks.length
          ? currentSoup.tracks[currentTrackIndex]
          : null;

      // Загрузка playlist.json для выбранного супа
      useEffect(() => {
        const soup = soups.find((s) => s.id === currentSoupId);
        if (!soup || soup.tracksLoaded) return;

        const loadPlaylist = async () => {
          try {
            const res = await fetch(`${soup.basePath}/playlist.json`);
            if (!res.ok) throw new Error("playlist.json not found");
            const data = await res.json();
            const tracks = data.tracks || [];
            setSoups((prev) =>
              prev.map((s) =>
                s.id === soup.id
                  ? {
                      ...s,
                      tracks,
                      tracksLoaded: true,
                      playlistTitle: data.title || s.title,
                      playlistTagline: data.tagline || s.tagline
                    }
                  : s
              )
            );
          } catch (e) {
            console.error(e);
            setSoups((prev) =>
              prev.map((s) =>
                s.id === soup.id
                  ? { ...s, tracks: [], tracksLoaded: true }
                  : s
              )
            );
          }
        };
        loadPlaylist();
      }, [currentSoupId, soups]);

      // При смене трека — обновляем src
      useEffect(() => {
        const audio = audioRef.current;
        if (!audio || !currentSoup || !currentTrack) return;

        audio.src = `${currentSoup.basePath}/${currentTrack.file}`;
        audio.load();
        setCurrentTime(0);
        setDuration(0);

        const onLoaded = () => {
          setDuration(audio.duration || 0);
        };
        const onTime = () => {
          setCurrentTime(audio.currentTime || 0);
        };
        const onEnded = () => {
          if (!currentSoup.tracks || !currentSoup.tracks.length) return;
          setCurrentTrackIndex((prev) => {
            const count = currentSoup.tracks.length;
            if (!count) return prev;
            return prev + 1 < count ? prev + 1 : 0;
          });
        };

        audio.addEventListener("loadedmetadata", onLoaded);
        audio.addEventListener("timeupdate", onTime);
        audio.addEventListener("ended", onEnded);

        return () => {
          audio.removeEventListener("loadedmetadata", onLoaded);
          audio.removeEventListener("timeupdate", onTime);
          audio.removeEventListener("ended", onEnded);
        };
      }, [currentSoupId, currentTrackIndex, soups]);

      // Громкость (экспоненциально)
      useEffect(() => {
        const audio = audioRef.current;
        if (!audio) return;
        const n = Math.min(100, Math.max(0, volume)) / 100;
        audio.volume = n * n;
      }, [volume]);

      // Play / Pause
      useEffect(() => {
        const audio = audioRef.current;
        if (!audio) return;
        if (isPlaying && currentTrack && currentSoup) {
          audio.play().catch(() => {});
        } else {
          audio.pause();
        }
      }, [isPlaying, currentSoupId, currentTrackIndex, currentTrack, currentSoup]);

      const handleSelectSoup = (soup) => {
        setCurrentSoupId(soup.id);
        setCurrentTrackIndex(0);
        setIsPlaying(true);
      };

      const handlePlayPause = () => {
        if (!currentTrack || !currentSoup) return;
        setIsPlaying((p) => !p);
      };

      const handleNext = () => {
        if (!currentSoup || !currentSoup.tracks.length) return;
        setCurrentTrackIndex((prev) => {
          const count = currentSoup.tracks.length;
          if (!count) return prev;
          return prev + 1 < count ? prev + 1 : 0;
        });
      };

      const handlePrev = () => {
        if (!currentSoup || !currentSoup.tracks.length) return;
        setCurrentTrackIndex((prev) => {
          const count = currentSoup.tracks.length;
          if (!count) return prev;
          return prev - 1 >= 0 ? prev - 1 : count - 1;
        });
      };

      // FWD scratch — ускоренное воспроизведение с повышенным тоном
      const startForwardScratch = () => {
        const audio = audioRef.current;
        if (!audio || !currentTrack) return;
        setForwardCue(true);
        setJogClass("jog-forward");
        setTimeout(() => setJogClass(""), 220);
        audio.playbackRate = 2.3;
        setIsPlaying(true);
      };

      const stopForwardScratch = () => {
        const audio = audioRef.current;
        if (!audio) return;
        setForwardCue(false);
        audio.playbackRate = 1;
      };

      // REW — быстрый реверс по времени
      const startRewind = () => {
        const audio = audioRef.current;
        if (!audio || !currentTrack) return;
        setRewinding(true);
        setJogClass("jog-back");
        setTimeout(() => setJogClass(""), 220);

        audio.pause();
        if (rewIntervalRef.current) clearInterval(rewIntervalRef.current);
        rewIntervalRef.current = setInterval(() => {
          if (!audio.duration) return;
          const nextTime = Math.max(0, audio.currentTime - 0.18);
          audio.currentTime = nextTime;
          setCurrentTime(nextTime);
        }, 40);
      };

      const stopRewind = () => {
        const audio = audioRef.current;
        setRewinding(false);
        if (rewIntervalRef.current) {
          clearInterval(rewIntervalRef.current);
          rewIntervalRef.current = null;
        }
        if (audio && isPlaying) {
          audio.play();
        }
      };

      // Колёсиком — громкость
      const handleVolumeWheel = (e) => {
        e.preventDefault();
        const direction = e.deltaY > 0 ? -1 : 1;
        const step = 5;
        setVolume((v) => Math.max(0, Math.min(100, v + direction * step)));
      };

      const currentTimeText = formatTime(currentTime);
      const durationText = formatTime(duration);
      const soupOfDayTitle = currentSoup?.playlistTitle || currentSoup?.title || "";

      const trackTitle =
        currentTrack?.title ||
        currentTrack?.file ||
        (currentSoup ? `Track ${currentTrackIndex + 1}` : "Нет трека");

      const trackSubtitle = currentSoup
        ? `${currentTrackIndex + 1}/${currentSoup.tracks.length} • ${
            currentSoup.type === "day" ? "Суп дня" : "Кассета"
          }`
        : "";

      const timeText = `${currentTimeText} / ${durationText}`;

      // Тюнер-процент — псевдо, просто по прогрессу
      const tunerPercent = duration ? Math.min(1, currentTime / duration) : 0;

      return (
        <div className="w-full flex flex-col items-center gap-6 no-select">
          {/* Заголовок SUPDNYA (вместо Sony) */}
          <div className="text-center mb-2">
            <div className="text-sm tracking-[0.6em] uppercase text-neutral-300/80 font-mono">
              SUPDNYA
            </div>
            <div className="text-xl md:text-2xl mt-2 font-semibold tracking-[0.3em] uppercase text-neutral-100">
              Суп дня
            </div>
          </div>

          {/* Полка кассет */}
          <section className="w-full max-w-5xl">
            <div className="rounded-3xl bg-gradient-to-b from-neutral-900/90 to-black/90 p-4 shadow-[0_1.5rem_3.5rem_rgba(0,0,0,0.9)] border border-neutral-800/80">
              <div className="flex items-center justify-between mb-3">
                <span className="text-xs font-mono text-neutral-400 tracking-[0.2em] uppercase">
                  Кассеты
                </span>
                {loadingSoups && (
                  <span className="text-[0.7rem] text-neutral-500 font-mono">
                    Загрузка…
                  </span>
                )}
              </div>
              <div className="flex gap-4 overflow-x-auto no-scrollbar pb-2">
                {soups.map((s) => (
                  <Cassette
                    key={s.id}
                    soup={s}
                    active={s.id === currentSoupId}
                    onSelect={handleSelectSoup}
                  />
                ))}
                {!soups.length && !loadingSoups && (
                  <div className="text-xs text-neutral-300 font-mono">
                    Добавьте soups/index.json и плейлисты.
                  </div>
                )}
              </div>
              {soupsError && (
                <div className="mt-2 text-[0.7rem] text-red-400 font-mono">
                  {soupsError}
                </div>
              )}
            </div>
          </section>

          {/* Основной плеер / радиоприёмник */}
          <section className="w-full max-w-4xl">
            <div
              className={[
                "device-shell mx-auto transition-transform duration-150",
                jogClass
              ].join(" ")}
            >
              {/* Верхние REW/FWD как у плейера */}
              <div className="flex justify-end gap-2 mb-2 pr-4">
                <button
                  className="top-key font-mono text-neutral-800"
                  onMouseDown={startRewind}
                  onMouseUp={stopRewind}
                  onMouseLeave={stopRewind}
                  onTouchStart={(e) => { e.preventDefault(); startRewind(); }}
                  onTouchEnd={stopRewind}
                >
                  REW
                </button>
                <button
                  className="top-key font-mono text-neutral-800"
                  onMouseDown={startForwardScratch}
                  onMouseUp={stopForwardScratch}
                  onMouseLeave={stopForwardScratch}
                  onTouchStart={(e) => { e.preventDefault(); startForwardScratch(); }}
                  onTouchEnd={stopForwardScratch}
                >
                  FWD
                </button>
              </div>

              <div className="device-inner">
                <div className="flex flex-col md:flex-row gap-5 items-stretch">
                  {/* Динамик (вдавленный) */}
                  <div className="w-full md:w-1/3 flex items-center justify-center">
                    <div className="w-full max-w-xs aspect-square concave-speaker">
                      <div className="speaker-pattern" />
                    </div>
                  </div>

                  {/* Центральная часть: дисплей + тюнер + управление */}
                  <div className="flex-1 flex flex-col gap-4">
                    {/* Вдавленный дисплей */}
                    <div className="concave-display p-4 md:p-5">
                      <div className="display-glow" />
                      <div className="relative z-10 flex flex-col gap-2">
                        {/* Верхняя строка: время и статус */}
                        <div className="flex items-center justify-between text-[0.7rem] font-mono text-emerald-200/80 uppercase tracking-[0.18em]">
                          <span>{timeText}</span>
                          <span className={isPlaying ? "text-emerald-300" : "text-emerald-700"}>
                            {isPlaying
                              ? forwardCue
                                ? "CUE >>"
                                : rewinding
                                ? "<< REW"
                                : "PLAY"
                              : "PAUSE"}
                          </span>
                        </div>

                        {/* Название трека КРУПНО */}
                        <div className="mt-1">
                          <div className="text-base md:text-lg font-mono tracking-tight truncate text-emerald-100">
                            {trackTitle}
                          </div>
                          <div className="text-[0.75rem] text-emerald-400/90 font-mono mt-1 truncate">
                            {trackSubtitle}
                          </div>
                        </div>

                        {/* Нижняя строка: суп дня / инфа про суп */}
                        <div className="mt-2 pt-2 border-t border-emerald-900/70 flex items-center justify-between text-[0.7rem] font-mono text-emerald-500/90">
                          <span className="uppercase tracking-[0.18em]">
                            Суп дня
                          </span>
                          <span className="truncate text-right">
                            {soupOfDayTitle}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* Тюнер (радиошкала) */}
                    <div className="rounded-xl bg-gradient-to-b from-neutral-900 to-black px-4 py-3 border border-neutral-700/80 shadow-[inset_0.09rem_0.09rem_0.4rem_rgba(0,0,0,0.95)]">
                      <div className="flex justify-between text-[0.6rem] font-mono text-neutral-400 uppercase tracking-[0.2em] mb-2">
                        <span>FM</span>
                        <span>SUPDNYA DIAL</span>
                        <span>STEREO</span>
                      </div>
                      <div className="relative h-8 flex items-center">
                        <div className="w-full h-[0.09rem] bg-gradient-to-r from-emerald-900 via-emerald-400/80 to-emerald-900 opacity-80" />
                        {/* Деления */}
                        <div className="absolute inset-x-0 top-0 flex justify-between text-[0.6rem] font-mono text-neutral-400">
                          {["88","92","96","100","104","108"].map((v) => (
                            <span key={v}>{v}</span>
                          ))}
                        </div>
                        {/* Бегунок по шкале */}
                        <div
                          className="absolute top-0 bottom-0 flex items-center transition-all duration-150"
                          style={{ left: `${tunerPercent * 100}%`, transform: "translateX(-50%)" }}
                        >
                          <div className="w-[0.1rem] h-full bg-gradient-to-b from-rose-100 via-rose-500 to-rose-900 shadow-[0_0_0.5rem_rgba(248,113,113,0.9)]" />
                        </div>
                      </div>
                    </div>

                    {/* Панель управления */}
                    <div className="rounded-2xl bg-gradient-to-br from-neutral-900 to-neutral-800 p-4 border border-neutral-700/80 shadow-[inset_0.09rem_0.09rem_0.25rem_rgba(255,255,255,0.1),0_0.9rem_1.6rem_rgba(0,0,0,0.8)]">
                      <div className="flex items-center justify-between gap-4">
                        {/* Кнопки транспорта */}
                        <div className="flex items-center gap-3">
                          <button
                            className="round-button w-10 h-10 flex items-center justify-center font-mono text-sm"
                            onClick={handlePrev}
                          >
                            {"<<"}
                          </button>
                          <button
                            className={[
                              "round-button w-12 h-12 flex items-center justify-center font-mono text-base",
                              isPlaying ? "bg-gradient-to-br from-orange-300 to-orange-500" : ""
                            ].join(" ")}
                            onClick={handlePlayPause}
                          >
                            {isPlaying ? "II" : "▶"}
                          </button>
                          <button
                            className="round-button w-10 h-10 flex items-center justify-center font-mono text-sm"
                            onClick={handleNext}
                          >
                            {">>"}
                          </button>
                        </div>

                        {/* Маленький спектр + громкость */}
                        <div className="flex-1 flex items-center justify-end gap-4">
                          <MiniSpectrum active={isPlaying} />
                          <div
                            className="flex items-center gap-2 text-xs font-mono text-neutral-300"
                            onWheel={handleVolumeWheel}
                          >
                            <span className="text-[0.7rem]">VOL</span>
                            <div className="w-28 h-3 rounded-full bg-neutral-700/90 shadow-[inset_0.06rem_0.06rem_0.18rem_rgba(0,0,0,0.9)] relative overflow-hidden">
                              <input
                                type="range"
                                min="0"
                                max="100"
                                value={volume}
                                onChange={(e) => setVolume(Number(e.target.value))}
                                className="absolute inset-0 opacity-0 cursor-pointer"
                              />
                              <div
                                className="h-full bg-gradient-to-r from-orange-300 via-orange-500 to-orange-600"
                                style={{ width: `${volume}%` }}
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Скрытый audio */}
                    <audio ref={audioRef} className="hidden" />
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
